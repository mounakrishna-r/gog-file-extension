<!DOCTYPE html>
<html lang="">
<head>
    <title>GOG Studio</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 0; padding: 20px; }

        .top-bar { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; }
        .buttons { display: flex; gap: 10px; }
        .container { display: flex; gap: 30px; transition: all 0.3s ease; }

        .panel { flex: 1; padding: 20px; background: #f4f4f4; border-radius: 8px; }

        .metadata-panel.hidden { display: none; }

        label { font-weight: bold; margin-top: 10px; display: block; }
        input, select, textarea {
          width: 100%;
          padding: 6px;
          margin-top: 4px;
          box-sizing: border-box;
        }

        textarea { height: 120px; font-family: monospace; }
        .readonly-content { height: 400px; }

        .button { padding: 10px 20px; font-weight: bold; cursor: pointer; }
        .button.primary { background-color: #007BFF; color: white; border: none; }
        .button.secondary { background-color: #28A745; color: white; border: none; }

        .layout-label {
          font-size: 14px;
          color: #444;
          margin-bottom: 10px;
        }
    </style>
</head>
<body>

<h1>GOG Studio</h1>

<form method="POST" enctype="multipart/form-data">

    <!-- üîπ TOP BAR -->
    <div class="top-bar">
        <div class="buttons">
            <input type="file" name="file" accept=".gog">
            <button class="button primary" type="submit" name="action" value="upload">Upload</button>
            <button class="button secondary" type="submit" name="action" value="regenerate">Regenerate</button>
            <button class="button" type="submit" name="action" value="download">Download</button>
        </div>

        <!-- üîò Toggle Button -->
        <button type="button" class="button" onclick="toggleMetadata()">üõ† Toggle Metadata</button>
    </div>

    <!-- üîπ MAIN CONTAINER -->
    <div class="container" id="gogContainer">

        <!-- üßæ Metadata Form -->
        <div class="panel metadata-panel" id="metadataPanel">
            <h3>Metadata</h3>

            <label>Title</label>
            <label>
                <input name="meta_title" value="" placeholder="Enter title">
            </label>

            <label>Author</label>
            <label>
                <input name="meta_author" value="" placeholder="meta.author or 'Enter author">
            </label>

            <label>Created</label>
            <label>
                <input name="meta_created" value="meta.created" readonly>
            </label>

            <label>GPT Engine</label>
            <label>
                <select name="meta_gpt_engine">
                    <option>gpt-3.5-turbo</option>
                    <option>gpt-4</option>
                    <option>gpt-4o</option>
                </select>
            </label>

            <h3>Prompt</h3>

            <label>Audience</label>
            <label>
                <input name="prompt_audience" value="" placeholder="Enter audience">
            </label>

            <label>Tone</label>
            <label>
                <select name="prompt_tone">
                    <option>casual</option>
                    <option>academic</option>
                    <option>poetic</option>
                </select>
            </label>

            <label>Format</label>
            <label>
                <input name="prompt_format" value="" placeholder="Enter format">
            </label>

            <label>Context</label>
            <label>
                <textarea name="prompt_context" placeholder="Enter context"></textarea>
            </label>

            <h3>Render</h3>

            <label>Font</label>
            <label>
                <select name="render_font">
                    <option>Arial</option>
                    <option>Courier New</option>
                    <option>Georgia</option>
                    <option>Times New Roman</option>
                    <option>Verdana</option>
                    <option>Comic Sans MS</option>
                    <option>Impact</option>
                    <option>Tahoma</option>
                    <option>Trebuchet MS</option>
                    <option>Lucida Console</option>
                    <option>Palatino Linotype</option>
                </select>
            </label>

            <label>Font Size</label>
            <label>
                <select name="render_font_size">
                    <option>10</option>
                    <option>12</option>
                    <option>14</option>
                    <option>16</option>
                    <option>18</option>
                </select>
            </label>

            <label>Layout</label>
            <label for="layoutSelect"></label><select name="render_layout" id="layoutSelect" onchange="updateLayoutLabel()">
                <option>A4</option>
                <option>A5</option>
                <option>Letter</option>
                <option>Legal</option>
            </select>

            <label>Margin</label>
            <label>
                <input name="render_margin" value="" placeholder="Enter margin">
            </label>

            <label>Include Headings</label>
            <label>
                <input type="checkbox" name="render_include_headings">
            </label>
        </div>

        <!-- üìÑ Generated Content -->
        <div class="panel">
            {% if content.generated %}
            <div class="layout-label" id="layoutLabel">Page: {{ render.layout or 'A4' }} ‚Äì 210mm x 297mm</div>
            {% endif %}

            <h3>Generated Content</h3>
            <label>
                <textarea class="readonly-content" readonly></textarea>
            </label>
        </div>
    </div>
</form>

<script>
    // üß† Toggle the metadata panel
    function toggleMetadata() {
      const panel = document.getElementById('metadataPanel');
      panel.classList.toggle('hidden');
    }

    // üìê Update layout label when dropdown changes
    function updateLayoutLabel() {
      const layout = document.getElementById('layoutSelect').value;
      const label = document.getElementById('layoutLabel');
      const sizes = {
        A4: "210mm x 297mm",
        A5: "148mm x 210mm",
        Letter: "216mm x 279mm",
        Legal: "216mm x 356mm"
      };
      if (label) {
        label.innerText = `Page: ${layout} ‚Äì ${sizes[layout] || "Unknown size"}`;
      }
    }

    // Initialize layout label once
    updateLayoutLabel();
</script>

</body>
</html>